<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Management System</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    
    <!-- jsPDF for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC0z364Ti3fBTrcVzAPgyQamA-JioGTPXo",
            authDomain: "employee-management-36cb3.firebaseapp.com",
            projectId: "employee-management-36cb3",
            storageBucket: "employee-management-36cb3.firebasestorage.app",
            messagingSenderId: "114401704510",
            appId: "1:114401704510:web:205da2b3ccae3533bbaf6f",
            measurementId: "G-JT8FQB7VTE"
        };
        
        // Initialize Firebase
        let db;
        let useFirebase = false;
        
        try {
            if (firebaseConfig.apiKey !== "YOUR_API_KEY") {
                firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
                useFirebase = true;
                console.log("Firebase initialized successfully");
            } else {
                console.log("Firebase not configured - using localStorage");
            }
        } catch (error) {
            console.log("Firebase initialization failed - using localStorage", error);
        }
        
        // Lucide React icons as inline SVG components
        const Clock = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        );
        
        const LogOut = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
        );
        
        const Edit2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
            </svg>
        );
        
        const Plus = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );
        
        const Eye = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
        );
        
        const EyeOff = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                <line x1="1" y1="1" x2="23" y2="23"></line>
            </svg>
        );
        
        const Trash2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );
        
        const Save = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                <polyline points="17 21 17 13 7 13 7 21"></polyline>
                <polyline points="7 3 7 8 15 8"></polyline>
            </svg>
        );
        
        const X = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );
        
        const AlertCircle = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );
        
        const Users = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        );
        
        const Download = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        );
        
        const Calendar = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        );
        
        const Filter = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
            </svg>
        );
        
        const ChevronUp = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="18 15 12 9 6 15"></polyline>
            </svg>
        );
        
        const ChevronDown = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        );

        // IP Address Restriction Configuration
        const IPRestriction = {
            enabled: true, // Set to false to disable IP checking globally
            
            checkEmployeeIP: async (employee) => {
                if (!IPRestriction.enabled) {
                    return { allowed: true, ip: 'IP checking disabled' };
                }
                
                // If employee has no IPs configured, allow access (for backward compatibility)
                if (!employee.allowedIPs || employee.allowedIPs.length === 0) {
                    return { allowed: true, ip: 'No IP restriction set for this employee' };
                }
                
                try {
                    // Get user's IP address
                    const response = await fetch('https://api.ipify.org?format=json');
                    const data = await response.json();
                    const userIP = data.ip;
                    
                    const allowed = employee.allowedIPs.includes(userIP);
                    return { allowed, ip: userIP, allowedIPs: employee.allowedIPs };
                } catch (error) {
                    console.error('Error checking IP:', error);
                    // If IP check fails, allow access (you can change this to deny if preferred)
                    return { allowed: true, ip: 'IP check failed' };
                }
            }
        };

        // Session management helper functions
        const SessionManager = {
            saveSession: (type, data) => {
                const session = {
                    type: type, // 'owner' or 'employee'
                    data: data,
                    loginTime: new Date().getTime(),
                    expiresIn: 8 * 60 * 60 * 1000 // 8 hours in milliseconds
                };
                localStorage.setItem('userSession', JSON.stringify(session));
            },
            
            getSession: () => {
                const stored = localStorage.getItem('userSession');
                if (!stored) return null;
                
                const session = JSON.parse(stored);
                const currentTime = new Date().getTime();
                const sessionAge = currentTime - session.loginTime;
                
                // Check if session has expired (8 hours)
                if (sessionAge > session.expiresIn) {
                    SessionManager.clearSession();
                    return null;
                }
                
                return session;
            },
            
            clearSession: () => {
                localStorage.removeItem('userSession');
            },
            
            isSessionValid: () => {
                return SessionManager.getSession() !== null;
            }
        };

        // Storage helper functions
        const Storage = {
            getOwner: () => {
                const stored = localStorage.getItem('owner');
                return stored ? JSON.parse(stored) : { username: 'admin', password: 'admin123' };
            },
            
            getEmployees: () => {
                const stored = localStorage.getItem('employees');
                return stored ? JSON.parse(stored) : [
                    {
                        id: 1,
                        username: 'john.doe',
                        password: 'pass123',
                        name: 'John Doe',
                        allowedIPs: [], // Add office IPs for this employee
                        clockedIn: false,
                        clockInTime: null,
                        clockOutTime: null,
                        workHistory: [],
                        dailyTasks: [
                            { id: 1, task: 'Check emails', completed: false },
                            { id: 2, task: 'Update daily report', completed: false },
                            { id: 3, task: 'Team standup meeting', completed: false }
                        ],
                        assignedTasks: [
                            { id: 1, task: 'Complete project documentation', completed: false },
                            { id: 2, task: 'Review code submissions', completed: false }
                        ]
                    },
                    {
                        id: 2,
                        username: 'jane.smith',
                        password: 'pass456',
                        name: 'Jane Smith',
                        allowedIPs: [], // Add office IPs for this employee
                        clockedIn: false,
                        clockInTime: null,
                        clockOutTime: null,
                        workHistory: [],
                        dailyTasks: [
                            { id: 1, task: 'Check emails', completed: false },
                            { id: 2, task: 'Update daily report', completed: false }
                        ],
                        assignedTasks: [
                            { id: 1, task: 'Client presentation prep', completed: false }
                        ]
                    }
                ];
            },
            
            saveEmployees: (employees) => {
                localStorage.setItem('employees', JSON.stringify(employees));
            },
            
            saveOwner: (owner) => {
                localStorage.setItem('owner', JSON.stringify(owner));
            }
        };

        // Firebase helper functions
        const FirebaseDB = {
            loadEmployees: async (setEmployees) => {
                if (!useFirebase) {
                    setEmployees(Storage.getEmployees());
                    return;
                }
                
                try {
                    const snapshot = await db.collection('employees').get();
                    const employees = [];
                    snapshot.forEach(doc => {
                        employees.push({ ...doc.data(), id: doc.id });
                    });
                    
                    if (employees.length === 0) {
                        // Initialize with default employees
                        const defaultEmployees = Storage.getEmployees();
                        for (const emp of defaultEmployees) {
                            await db.collection('employees').doc(emp.id.toString()).set(emp);
                        }
                        setEmployees(defaultEmployees);
                    } else {
                        setEmployees(employees);
                    }
                } catch (error) {
                    console.error("Error loading employees:", error);
                    setEmployees(Storage.getEmployees());
                }
            },
            
            saveEmployee: async (employee) => {
                if (!useFirebase) {
                    return;
                }
                
                try {
                    await db.collection('employees').doc(employee.id.toString()).set(employee);
                } catch (error) {
                    console.error("Error saving employee:", error);
                }
            },
            
            deleteEmployee: async (employeeId) => {
                if (!useFirebase) {
                    return;
                }
                
                try {
                    await db.collection('employees').doc(employeeId.toString()).delete();
                } catch (error) {
                    console.error("Error deleting employee:", error);
                }
            }
        };

        const App = () => {
            const [currentView, setCurrentView] = useState('selectRole');
            const [ownerDashboardView, setOwnerDashboardView] = useState('history'); // 'history' or 'manage'
            const [employees, setEmployees] = useState([]);
            const [currentEmployee, setCurrentEmployee] = useState(null);
            const [loginForm, setLoginForm] = useState({ username: '', password: '' });
            const [error, setError] = useState('');
            const [editingEmployee, setEditingEmployee] = useState(null);
            const [showPassword, setShowPassword] = useState({});
            const [newEmployee, setNewEmployee] = useState({ username: '', password: '', name: '' });
            const [editingDailyTasks, setEditingDailyTasks] = useState(null);
            const [newDailyTask, setNewDailyTask] = useState('');
            const [newAssignedTask, setNewAssignedTask] = useState('');
            const [addingTaskTo, setAddingTaskTo] = useState(null);
            const [loading, setLoading] = useState(true);
            
            // New state for date range filter and editing work history
            const [dateRangeFilter, setDateRangeFilter] = useState({ start: '', end: '' });
            const [editingWorkEntry, setEditingWorkEntry] = useState(null);
            const [editingWorkTimes, setEditingWorkTimes] = useState({ clockIn: '', clockOut: '' });
            
            // State for editing task text
            const [editingTaskId, setEditingTaskId] = useState(null);
            const [editingTaskText, setEditingTaskText] = useState('');

            // Check for existing session on mount
            useEffect(() => {
                const session = SessionManager.getSession();
                if (session) {
                    if (session.type === 'owner') {
                        setCurrentView('ownerDashboard');
                    } else if (session.type === 'employee') {
                        // Find the employee in the data
                        const loadEmployeeSession = async () => {
                            await FirebaseDB.loadEmployees(setEmployees);
                            // We'll set the employee after data loads
                        };
                        loadEmployeeSession();
                    }
                }
            }, []);

            // Restore employee session after employees are loaded
            useEffect(() => {
                if (employees.length > 0 && currentView === 'selectRole') {
                    const session = SessionManager.getSession();
                    if (session && session.type === 'employee') {
                        const employee = employees.find(emp => emp.id === session.data.id);
                        if (employee) {
                            setCurrentEmployee(employee);
                            setCurrentView('employeeDashboard');
                        }
                    }
                }
            }, [employees]);

            // Load employees on mount
            useEffect(() => {
                const loadData = async () => {
                    await FirebaseDB.loadEmployees(setEmployees);
                    setLoading(false);
                };
                loadData();
            }, []);

            // Save employees whenever they change
            useEffect(() => {
                if (!loading && employees.length > 0) {
                    Storage.saveEmployees(employees);
                    
                    if (useFirebase) {
                        employees.forEach(emp => {
                            FirebaseDB.saveEmployee(emp);
                        });
                    }
                }
            }, [employees, loading]);

            // Prevent closing browser/tab without clocking out
            useEffect(() => {
                if (currentView === 'employeeDashboard' && currentEmployee?.clockedIn) {
                    const handleBeforeUnload = (e) => {
                        e.preventDefault();
                        e.returnValue = 'You are still clocked in! Please clock out before leaving.';
                        return 'You are still clocked in! Please clock out before leaving.';
                    };
                    
                    window.addEventListener('beforeunload', handleBeforeUnload);
                    return () => window.removeEventListener('beforeunload', handleBeforeUnload);
                }
            }, [currentView, currentEmployee]);

            const handleOwnerLogin = (e) => {
                e.preventDefault();
                const owner = Storage.getOwner();
                if (loginForm.username === owner.username && loginForm.password === owner.password) {
                    SessionManager.saveSession('owner', { username: owner.username });
                    setCurrentView('ownerDashboard');
                    setError('');
                    setLoginForm({ username: '', password: '' });
                } else {
                    setError('Invalid credentials');
                }
            };

            const handleEmployeeLogin = async (e) => {
                e.preventDefault();
                
                const employee = employees.find(
                    emp => emp.username === loginForm.username && emp.password === loginForm.password
                );
                
                if (!employee) {
                    setError('Invalid credentials');
                    return;
                }
                
                // Check IP address for this specific employee
                const ipCheck = await IPRestriction.checkEmployeeIP(employee);
                if (!ipCheck.allowed) {
                    setError(`Access denied. You can only login from your assigned office location(s). Your current IP: ${ipCheck.ip}`);
                    return;
                }
                
                SessionManager.saveSession('employee', { id: employee.id, username: employee.username });
                setCurrentEmployee(employee);
                setCurrentView('employeeDashboard');
                setError('');
                setLoginForm({ username: '', password: '' });
            };

            const handleClockIn = () => {
                const now = new Date();
                const updatedEmployees = employees.map(emp =>
                    emp.id === currentEmployee.id
                        ? { ...emp, clockedIn: true, clockInTime: now.toISOString() }
                        : emp
                );
                setEmployees(updatedEmployees);
                setCurrentEmployee({ ...currentEmployee, clockedIn: true, clockInTime: now.toISOString() });
            };

            const handleClockOut = () => {
                const allDailyTasksCompleted = currentEmployee.dailyTasks.every(task => task.completed);
                
                if (!allDailyTasksCompleted) {
                    setError('You must complete all daily tasks before clocking out!');
                    setTimeout(() => setError(''), 4000);
                    return;
                }

                const now = new Date();
                const clockInDate = new Date(currentEmployee.clockInTime);
                const hoursWorked = ((now - clockInDate) / (1000 * 60 * 60)).toFixed(2);
                
                // Create work history entry
                const workEntry = {
                    id: Date.now(),
                    date: now.toISOString(),
                    clockIn: currentEmployee.clockInTime,
                    clockOut: now.toISOString(),
                    hoursWorked: parseFloat(hoursWorked)
                };
                
                const updatedEmployees = employees.map(emp =>
                    emp.id === currentEmployee.id
                        ? { 
                            ...emp, 
                            clockedIn: false, 
                            clockOutTime: now.toISOString(),
                            workHistory: [...(emp.workHistory || []), workEntry],
                            dailyTasks: emp.dailyTasks.map(task => ({ ...task, completed: false })),
                            assignedTasks: emp.assignedTasks.filter(task => !task.completed)
                        }
                        : emp
                );
                setEmployees(updatedEmployees);
                setCurrentEmployee({ 
                    ...currentEmployee, 
                    clockedIn: false, 
                    clockOutTime: now.toISOString(),
                    workHistory: [...(currentEmployee.workHistory || []), workEntry],
                    dailyTasks: currentEmployee.dailyTasks.map(task => ({ ...task, completed: false })),
                    assignedTasks: currentEmployee.assignedTasks.filter(task => !task.completed)
                });
                setError('');
            };

            const handleEmployeeSignOut = () => {
                if (currentEmployee?.clockedIn) {
                    setError('Please clock out before signing out!');
                    setTimeout(() => setError(''), 4000);
                    return;
                }
                SessionManager.clearSession();
                setCurrentEmployee(null);
                setCurrentView('selectRole');
                setError('');
            };

            const toggleDailyTask = (taskId) => {
                const updatedTasks = currentEmployee.dailyTasks.map(task =>
                    task.id === taskId ? { ...task, completed: !task.completed } : task
                );
                const updatedEmployee = { ...currentEmployee, dailyTasks: updatedTasks };
                setCurrentEmployee(updatedEmployee);
                
                const updatedEmployees = employees.map(emp =>
                    emp.id === currentEmployee.id ? updatedEmployee : emp
                );
                setEmployees(updatedEmployees);
            };

            const toggleAssignedTask = (taskId) => {
                const updatedTasks = currentEmployee.assignedTasks.map(task =>
                    task.id === taskId ? { ...task, completed: !task.completed } : task
                );
                const updatedEmployee = { ...currentEmployee, assignedTasks: updatedTasks };
                setCurrentEmployee(updatedEmployee);
                
                const updatedEmployees = employees.map(emp =>
                    emp.id === currentEmployee.id ? updatedEmployee : emp
                );
                setEmployees(updatedEmployees);
            };

            const handleAddEmployee = (e) => {
                e.preventDefault();
                if (newEmployee.username && newEmployee.password && newEmployee.name) {
                    const employee = {
                        id: Date.now(),
                        username: newEmployee.username,
                        password: newEmployee.password,
                        name: newEmployee.name,
                        allowedIPs: [],
                        clockedIn: false,
                        clockInTime: null,
                        clockOutTime: null,
                        workHistory: [],
                        dailyTasks: [],
                        assignedTasks: []
                    };
                    setEmployees([...employees, employee]);
                    setNewEmployee({ username: '', password: '', name: '' });
                }
            };

            const handleUpdateEmployee = (employeeId, updates) => {
                const updatedEmployees = employees.map(emp =>
                    emp.id === employeeId ? { ...emp, ...updates } : emp
                );
                setEmployees(updatedEmployees);
                setEditingEmployee(null);
            };

            const handleDeleteEmployee = async (employeeId) => {
                if (window.confirm('Are you sure you want to delete this employee?')) {
                    setEmployees(employees.filter(emp => emp.id !== employeeId));
                    await FirebaseDB.deleteEmployee(employeeId);
                }
            };

            const handleAddDailyTask = (employeeId) => {
                if (newDailyTask.trim()) {
                    const updatedEmployees = employees.map(emp => {
                        if (emp.id === employeeId) {
                            return {
                                ...emp,
                                dailyTasks: [...emp.dailyTasks, { id: Date.now(), task: newDailyTask, completed: false }]
                            };
                        }
                        return emp;
                    });
                    setEmployees(updatedEmployees);
                    setNewDailyTask('');
                }
            };

            const handleDeleteDailyTask = (employeeId, taskId) => {
                const updatedEmployees = employees.map(emp => {
                    if (emp.id === employeeId) {
                        return {
                            ...emp,
                            dailyTasks: emp.dailyTasks.filter(task => task.id !== taskId)
                        };
                    }
                    return emp;
                });
                setEmployees(updatedEmployees);
            };

            const handleAddAssignedTask = (employeeId) => {
                if (newAssignedTask.trim()) {
                    const updatedEmployees = employees.map(emp => {
                        if (emp.id === employeeId) {
                            return {
                                ...emp,
                                assignedTasks: [...emp.assignedTasks, { id: Date.now(), task: newAssignedTask, completed: false }]
                            };
                        }
                        return emp;
                    });
                    setEmployees(updatedEmployees);
                    setNewAssignedTask('');
                }
            };
            
            const handleDeleteAssignedTask = (employeeId, taskId) => {
                const updatedEmployees = employees.map(emp => {
                    if (emp.id === employeeId) {
                        return {
                            ...emp,
                            assignedTasks: emp.assignedTasks.filter(task => task.id !== taskId)
                        };
                    }
                    return emp;
                });
                setEmployees(updatedEmployees);
            };
            
            const handleUpdateTaskText = (employeeId, taskId, newText, taskType) => {
                if (!newText.trim()) return;
                
                const updatedEmployees = employees.map(emp => {
                    if (emp.id === employeeId) {
                        return {
                            ...emp,
                            [taskType]: emp[taskType].map(task =>
                                task.id === taskId ? { ...task, task: newText } : task
                            )
                        };
                    }
                    return emp;
                });
                setEmployees(updatedEmployees);
                setEditingTaskId(null);
                setEditingTaskText('');
            };
            
            const handleMoveTask = (employeeId, taskId, direction, taskType) => {
                const updatedEmployees = employees.map(emp => {
                    if (emp.id === employeeId) {
                        const tasks = [...emp[taskType]];
                        const currentIndex = tasks.findIndex(t => t.id === taskId);
                        
                        if (currentIndex === -1) return emp;
                        
                        const newIndex = direction === 'up' ? currentIndex - 1 : currentIndex + 1;
                        
                        if (newIndex < 0 || newIndex >= tasks.length) return emp;
                        
                        // Swap tasks
                        [tasks[currentIndex], tasks[newIndex]] = [tasks[newIndex], tasks[currentIndex]];
                        
                        return {
                            ...emp,
                            [taskType]: tasks
                        };
                    }
                    return emp;
                });
                setEmployees(updatedEmployees);
            };
            
            // New handlers for owner dashboard features
            
            // Filter work history to last 30 days and by date range
            const filterWorkHistory = (workHistory) => {
                if (!workHistory || workHistory.length === 0) return [];
                
                const thirtyDaysAgo = new Date();
                thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                
                let filtered = workHistory.filter(entry => {
                    const entryDate = new Date(entry.date);
                    return entryDate >= thirtyDaysAgo;
                });
                
                // Apply date range filter if set
                if (dateRangeFilter.start) {
                    const startDate = new Date(dateRangeFilter.start);
                    startDate.setHours(0, 0, 0, 0);
                    filtered = filtered.filter(entry => new Date(entry.date) >= startDate);
                }
                
                if (dateRangeFilter.end) {
                    const endDate = new Date(dateRangeFilter.end);
                    endDate.setHours(23, 59, 59, 999);
                    filtered = filtered.filter(entry => new Date(entry.date) <= endDate);
                }
                
                return filtered;
            };
            
            // Update work entry times
            const handleUpdateWorkEntry = (employeeId, entryId, newClockIn, newClockOut) => {
                const clockInDate = new Date(newClockIn);
                const clockOutDate = new Date(newClockOut);
                
                if (clockOutDate <= clockInDate) {
                    alert('Clock out time must be after clock in time!');
                    return;
                }
                
                const hoursWorked = ((clockOutDate - clockInDate) / (1000 * 60 * 60));
                
                const updatedEmployees = employees.map(emp => {
                    if (emp.id === employeeId) {
                        return {
                            ...emp,
                            workHistory: emp.workHistory.map(entry => 
                                entry.id === entryId 
                                    ? {
                                        ...entry,
                                        clockIn: clockInDate.toISOString(),
                                        clockOut: clockOutDate.toISOString(),
                                        hoursWorked: parseFloat(hoursWorked.toFixed(2)),
                                        date: clockInDate.toISOString()
                                    }
                                    : entry
                            )
                        };
                    }
                    return emp;
                });
                
                setEmployees(updatedEmployees);
                setEditingWorkEntry(null);
            };
            
            // Export employee work history to PDF
            const exportToPDF = (employee) => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                const filteredHistory = filterWorkHistory(employee.workHistory || []);
                
                // Add title
                doc.setFontSize(20);
                doc.text(`Work History Report`, 105, 20, { align: 'center' });
                
                // Add employee info
                doc.setFontSize(12);
                doc.text(`Employee: ${employee.name}`, 20, 35);
                doc.text(`Username: ${employee.username}`, 20, 42);
                
                // Add date range
                const startDate = dateRangeFilter.start || 'Last 30 Days';
                const endDate = dateRangeFilter.end || 'Today';
                doc.text(`Period: ${startDate} to ${endDate}`, 20, 49);
                
                // Calculate totals
                const totalHours = filteredHistory.reduce((sum, entry) => sum + entry.hoursWorked, 0);
                doc.text(`Total Hours: ${totalHours.toFixed(2)} hrs`, 20, 56);
                
                // Add table headers
                doc.setFontSize(10);
                let y = 70;
                doc.setFont(undefined, 'bold');
                doc.text('Date', 20, y);
                doc.text('Clock In', 60, y);
                doc.text('Clock Out', 110, y);
                doc.text('Hours', 160, y);
                
                doc.setFont(undefined, 'normal');
                y += 7;
                
                // Group by date
                const historyByDate = {};
                filteredHistory.forEach(entry => {
                    const date = new Date(entry.date).toLocaleDateString('en-US', { 
                        year: 'numeric', 
                        month: 'short', 
                        day: 'numeric' 
                    });
                    if (!historyByDate[date]) {
                        historyByDate[date] = [];
                    }
                    historyByDate[date].push(entry);
                });
                
                // Add entries
                Object.keys(historyByDate).reverse().forEach(date => {
                    const dayEntries = historyByDate[date];
                    
                    dayEntries.forEach((entry) => {
                        if (y > 270) {
                            doc.addPage();
                            y = 20;
                        }
                        
                        const clockInTime = new Date(entry.clockIn).toLocaleTimeString('en-US', { 
                            hour: '2-digit', 
                            minute: '2-digit', 
                            hour12: true 
                        });
                        const clockOutTime = new Date(entry.clockOut).toLocaleTimeString('en-US', { 
                            hour: '2-digit', 
                            minute: '2-digit', 
                            hour12: true 
                        });
                        
                        doc.text(date, 20, y);
                        doc.text(clockInTime, 60, y);
                        doc.text(clockOutTime, 110, y);
                        doc.text(`${entry.hoursWorked.toFixed(2)} hrs`, 160, y);
                        y += 7;
                    });
                });
                
                // Save the PDF
                const fileName = `${employee.name.replace(/\s+/g, '_')}_work_history_${new Date().toISOString().split('T')[0]}.pdf`;
                doc.save(fileName);
            };

            const formatTime = (isoString) => {
                if (!isoString) return 'N/A';
                const date = new Date(isoString);
                return date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true });
            };

            const formatDate = (isoString) => {
                if (!isoString) return 'N/A';
                const date = new Date(isoString);
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
            };

            if (loading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center">
                        <div className="text-white text-2xl">Loading...</div>
                    </div>
                );
            }

            // Role Selection Screen
            if (currentView === 'selectRole') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-6">
                        <div className="absolute inset-0 bg-[radial-gradient(circle_at_50%_120%,rgba(120,119,198,0.1),transparent)]"></div>
                        <div className="max-w-4xl w-full relative">
                            <div className="text-center mb-12">
                                <h1 className="text-6xl font-bold text-white mb-3" style={{ fontFamily: 'Georgia, serif' }}>
                                    WorkFlow
                                </h1>
                                <p className="text-slate-400 text-lg">Employee Management System</p>
                            </div>
                            
                            <div className="grid md:grid-cols-2 gap-6">
                                <button
                                    onClick={() => setCurrentView('ownerLogin')}
                                    className="group relative bg-gradient-to-br from-amber-500 to-orange-600 hover:from-amber-400 hover:to-orange-500 text-white rounded-2xl p-12 shadow-2xl transition-all duration-300 hover:scale-105 hover:shadow-amber-500/25"
                                >
                                    <div className="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent rounded-2xl"></div>
                                    <div className="relative">
                                        <div className="w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:bg-white/30 transition-all">
                                            <Users size={32} />
                                        </div>
                                        <h2 className="text-3xl font-bold mb-2" style={{ fontFamily: 'Georgia, serif' }}>Owner</h2>
                                        <p className="text-amber-100">Access dashboard & manage employees</p>
                                    </div>
                                </button>

                                <button
                                    onClick={() => setCurrentView('employeeLogin')}
                                    className="group relative bg-gradient-to-br from-blue-500 to-indigo-600 hover:from-blue-400 hover:to-indigo-500 text-white rounded-2xl p-12 shadow-2xl transition-all duration-300 hover:scale-105 hover:shadow-blue-500/25"
                                >
                                    <div className="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent rounded-2xl"></div>
                                    <div className="relative">
                                        <div className="w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:bg-white/30 transition-all">
                                            <Clock size={32} />
                                        </div>
                                        <h2 className="text-3xl font-bold mb-2" style={{ fontFamily: 'Georgia, serif' }}>Employee</h2>
                                        <p className="text-blue-100">Clock in & manage your tasks</p>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Owner Login Screen
            if (currentView === 'ownerLogin') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-6">
                        <div className="absolute inset-0 bg-[radial-gradient(circle_at_50%_120%,rgba(120,119,198,0.1),transparent)]"></div>
                        <div className="max-w-md w-full relative">
                            <button
                                onClick={() => { setCurrentView('selectRole'); setError(''); setLoginForm({ username: '', password: '' }); }}
                                className="text-slate-400 hover:text-white mb-6 flex items-center gap-2 transition-colors"
                            >
                                ‚Üê Back
                            </button>
                            
                            <div className="bg-slate-800/50 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-slate-700/50">
                                <div className="w-16 h-16 bg-gradient-to-br from-amber-500 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-6">
                                    <Users size={32} className="text-white" />
                                </div>
                                
                                <h2 className="text-3xl font-bold text-white text-center mb-2" style={{ fontFamily: 'Georgia, serif' }}>
                                    Owner Login
                                </h2>
                                <p className="text-slate-400 text-center mb-8">Access your dashboard</p>
                                
                                {error && (
                                    <div className="bg-red-500/10 border border-red-500/50 text-red-400 px-4 py-3 rounded-lg mb-6 flex items-center gap-2">
                                        <AlertCircle size={18} />
                                        {error}
                                    </div>
                                )}
                                
                                <form onSubmit={handleOwnerLogin} className="space-y-5">
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">Username</label>
                                        <input
                                            type="text"
                                            value={loginForm.username}
                                            onChange={(e) => setLoginForm({ ...loginForm, username: e.target.value })}
                                            className="w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500 transition-all"
                                            placeholder="Enter username"
                                            required
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">Password</label>
                                        <input
                                            type="password"
                                            value={loginForm.password}
                                            onChange={(e) => setLoginForm({ ...loginForm, password: e.target.value })}
                                            className="w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500 transition-all"
                                            placeholder="Enter password"
                                            required
                                        />
                                    </div>
                                    
                                    <button
                                        type="submit"
                                        className="w-full bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-400 hover:to-orange-500 text-white font-semibold py-3 rounded-lg shadow-lg transition-all duration-300 hover:shadow-amber-500/25"
                                    >
                                        Sign In
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                );
            }

            // Employee Login Screen
            if (currentView === 'employeeLogin') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-6">
                        <div className="absolute inset-0 bg-[radial-gradient(circle_at_50%_120%,rgba(120,119,198,0.1),transparent)]"></div>
                        <div className="max-w-md w-full relative">
                            <button
                                onClick={() => { setCurrentView('selectRole'); setError(''); setLoginForm({ username: '', password: '' }); }}
                                className="text-slate-400 hover:text-white mb-6 flex items-center gap-2 transition-colors"
                            >
                                ‚Üê Back
                            </button>
                            
                            <div className="bg-slate-800/50 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-slate-700/50">
                                <div className="w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mx-auto mb-6">
                                    <Clock size={32} className="text-white" />
                                </div>
                                
                                <h2 className="text-3xl font-bold text-white text-center mb-2" style={{ fontFamily: 'Georgia, serif' }}>
                                    Employee Login
                                </h2>
                                <p className="text-slate-400 text-center mb-8">Start your workday</p>
                                
                                {error && (
                                    <div className="bg-red-500/10 border border-red-500/50 text-red-400 px-4 py-3 rounded-lg mb-6 flex items-center gap-2">
                                        <AlertCircle size={18} />
                                        {error}
                                    </div>
                                )}
                                
                                <form onSubmit={handleEmployeeLogin} className="space-y-5">
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">Username</label>
                                        <input
                                            type="text"
                                            value={loginForm.username}
                                            onChange={(e) => setLoginForm({ ...loginForm, username: e.target.value })}
                                            className="w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all"
                                            placeholder="Enter username"
                                            required
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-slate-300 mb-2">Password</label>
                                        <input
                                            type="password"
                                            value={loginForm.password}
                                            onChange={(e) => setLoginForm({ ...loginForm, password: e.target.value })}
                                            className="w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all"
                                            placeholder="Enter password"
                                            required
                                        />
                                    </div>
                                    
                                    <button
                                        type="submit"
                                        className="w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-400 hover:to-indigo-500 text-white font-semibold py-3 rounded-lg shadow-lg transition-all duration-300 hover:shadow-blue-500/25"
                                    >
                                        Sign In
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                );
            }

            // Owner Dashboard
            if (currentView === 'ownerDashboard') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900">
                        <div className="absolute inset-0 bg-[radial-gradient(circle_at_50%_120%,rgba(120,119,198,0.1),transparent)]"></div>
                        
                        <div className="relative border-b border-slate-700/50 bg-slate-800/30 backdrop-blur-xl">
                            <div className="max-w-7xl mx-auto px-6 py-4">
                                <div className="flex justify-between items-center mb-4">
                                    <div>
                                        <h1 className="text-3xl font-bold text-white" style={{ fontFamily: 'Georgia, serif' }}>WorkFlow</h1>
                                        <p className="text-slate-400 text-sm">Owner Dashboard</p>
                                    </div>
                                    <button
                                        onClick={() => {
                                            SessionManager.clearSession();
                                            setCurrentView('selectRole');
                                        }}
                                        className="flex items-center gap-2 px-4 py-2 bg-slate-700/50 hover:bg-slate-700 text-white rounded-lg transition-all"
                                    >
                                        <LogOut size={18} />
                                        Sign Out
                                    </button>
                                </div>
                                
                                {/* Navigation Tabs */}
                                <div className="flex gap-4">
                                    <button
                                        onClick={() => setOwnerDashboardView('history')}
                                        className={`px-6 py-3 rounded-lg font-semibold transition-all ${
                                            ownerDashboardView === 'history'
                                                ? 'bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg'
                                                : 'bg-slate-700/50 text-slate-300 hover:bg-slate-700'
                                        }`}
                                    >
                                        Employee Work History
                                    </button>
                                    <button
                                        onClick={() => setOwnerDashboardView('manage')}
                                        className={`px-6 py-3 rounded-lg font-semibold transition-all ${
                                            ownerDashboardView === 'manage'
                                                ? 'bg-gradient-to-r from-amber-500 to-orange-600 text-white shadow-lg'
                                                : 'bg-slate-700/50 text-slate-300 hover:bg-slate-700'
                                        }`}
                                    >
                                        Manage Employees & Tasks
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="relative max-w-7xl mx-auto px-6 py-8">
                            {/* Employee Work History View */}
                            {ownerDashboardView === 'history' && (
                                <div className="space-y-6">
                                    {/* Header with Date Range Filter */}
                                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                                        <h2 className="text-3xl font-bold text-white">Employee Work History (Last 30 Days)</h2>
                                        
                                        {/* Date Range Filter */}
                                        <div className="flex items-center gap-3 bg-slate-800/50 backdrop-blur-xl rounded-lg p-4 border border-slate-700/50">
                                            <Calendar size={20} className="text-blue-400" />
                                            <div className="flex flex-col sm:flex-row gap-2">
                                                <div className="flex flex-col">
                                                    <label className="text-xs text-slate-400 mb-1">From</label>
                                                    <input
                                                        type="date"
                                                        value={dateRangeFilter.start}
                                                        onChange={(e) => setDateRangeFilter({ ...dateRangeFilter, start: e.target.value })}
                                                        className="px-3 py-2 bg-slate-900/50 border border-slate-600 rounded text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                    />
                                                </div>
                                                <div className="flex flex-col">
                                                    <label className="text-xs text-slate-400 mb-1">To</label>
                                                    <input
                                                        type="date"
                                                        value={dateRangeFilter.end}
                                                        onChange={(e) => setDateRangeFilter({ ...dateRangeFilter, end: e.target.value })}
                                                        className="px-3 py-2 bg-slate-900/50 border border-slate-600 rounded text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                    />
                                                </div>
                                                {(dateRangeFilter.start || dateRangeFilter.end) && (
                                                    <button
                                                        onClick={() => setDateRangeFilter({ start: '', end: '' })}
                                                        className="self-end px-3 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded text-sm transition-colors"
                                                    >
                                                        Clear
                                                    </button>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {employees.map(employee => {
                                        const filteredHistory = filterWorkHistory(employee.workHistory || []);
                                        const totalHours = filteredHistory.reduce((sum, entry) => sum + entry.hoursWorked, 0);
                                        
                                        // Group work history by date
                                        const historyByDate = {};
                                        filteredHistory.forEach(entry => {
                                            const date = new Date(entry.date).toLocaleDateString('en-US', { 
                                                year: 'numeric', 
                                                month: 'long', 
                                                day: 'numeric' 
                                            });
                                            if (!historyByDate[date]) {
                                                historyByDate[date] = [];
                                            }
                                            historyByDate[date].push(entry);
                                        });
                                        
                                        return (
                                            <div key={employee.id} className="bg-slate-800/50 backdrop-blur-xl rounded-2xl shadow-xl border border-slate-700/50 overflow-hidden">
                                                {/* Employee Header */}
                                                <div className="bg-gradient-to-r from-slate-700/50 to-slate-800/50 p-6 border-b border-slate-700/50">
                                                    <div className="flex justify-between items-center">
                                                        <div>
                                                            <h3 className="text-2xl font-bold text-white mb-2">{employee.name}</h3>
                                                            <div className="flex items-center gap-4">
                                                                <div className="flex items-center gap-2">
                                                                    <div className={`w-3 h-3 rounded-full ${employee.clockedIn ? 'bg-green-500' : 'bg-slate-500'}`}></div>
                                                                    <span className="text-slate-300 text-sm">
                                                                        {employee.clockedIn ? 'Currently Working' : 'Not Working'}
                                                                    </span>
                                                                </div>
                                                                <span className="text-slate-400 text-sm">
                                                                    Total Hours: <span className="text-white font-bold">{totalHours.toFixed(2)} hrs</span>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <button
                                                            onClick={() => exportToPDF(employee)}
                                                            className="flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white rounded-lg transition-all shadow-lg"
                                                        >
                                                            <Download size={18} />
                                                            Export PDF
                                                        </button>
                                                    </div>
                                                </div>
                                                
                                                {/* Work History */}
                                                <div className="p-6">
                                                    {filteredHistory.length === 0 ? (
                                                        <p className="text-slate-400 text-center py-8">No work history in the selected period</p>
                                                    ) : (
                                                        <div className="space-y-4">
                                                            {Object.keys(historyByDate).reverse().map(date => {
                                                                const dayEntries = historyByDate[date];
                                                                const dayTotal = dayEntries.reduce((sum, entry) => sum + entry.hoursWorked, 0);
                                                                
                                                                return (
                                                                    <div key={date} className="border-l-4 border-blue-500 pl-4">
                                                                        <div className="flex justify-between items-center mb-3">
                                                                            <h4 className="text-lg font-semibold text-white">{date}</h4>
                                                                            <span className="text-blue-400 font-bold">{dayTotal.toFixed(2)} hours</span>
                                                                        </div>
                                                                        
                                                                        <div className="space-y-2">
                                                                            {dayEntries.map((entry, idx) => (
                                                                                <div key={entry.id || idx} className="bg-slate-900/30 rounded-lg p-3">
                                                                                    {editingWorkEntry === entry.id ? (
                                                                                        <div className="space-y-3">
                                                                                            <div className="flex gap-4 items-end flex-wrap">
                                                                                                <div className="flex flex-col">
                                                                                                    <label className="text-xs text-slate-400 mb-1">Clock In</label>
                                                                                                    <input
                                                                                                        type="datetime-local"
                                                                                                        defaultValue={new Date(entry.clockIn).toISOString().slice(0, 16)}
                                                                                                        onChange={(e) => setEditingWorkTimes({ ...editingWorkTimes, clockIn: e.target.value })}
                                                                                                        className="px-3 py-2 bg-slate-900/50 border border-slate-600 rounded text-white text-sm"
                                                                                                    />
                                                                                                </div>
                                                                                                <div className="flex flex-col">
                                                                                                    <label className="text-xs text-slate-400 mb-1">Clock Out</label>
                                                                                                    <input
                                                                                                        type="datetime-local"
                                                                                                        defaultValue={new Date(entry.clockOut).toISOString().slice(0, 16)}
                                                                                                        onChange={(e) => setEditingWorkTimes({ ...editingWorkTimes, clockOut: e.target.value })}
                                                                                                        className="px-3 py-2 bg-slate-900/50 border border-slate-600 rounded text-white text-sm"
                                                                                                    />
                                                                                                </div>
                                                                                                <button
                                                                                                    onClick={() => {
                                                                                                        const newClockIn = editingWorkTimes.clockIn || new Date(entry.clockIn).toISOString();
                                                                                                        const newClockOut = editingWorkTimes.clockOut || new Date(entry.clockOut).toISOString();
                                                                                                        handleUpdateWorkEntry(employee.id, entry.id, newClockIn, newClockOut);
                                                                                                    }}
                                                                                                    className="px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded transition-colors flex items-center gap-2"
                                                                                                >
                                                                                                    <Save size={16} />
                                                                                                    Save
                                                                                                </button>
                                                                                                <button
                                                                                                    onClick={() => setEditingWorkEntry(null)}
                                                                                                    className="px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded transition-colors flex items-center gap-2"
                                                                                                >
                                                                                                    <X size={16} />
                                                                                                    Cancel
                                                                                                </button>
                                                                                            </div>
                                                                                        </div>
                                                                                    ) : (
                                                                                        <div className="flex justify-between items-center">
                                                                                            <div className="flex gap-6 text-sm">
                                                                                                <span className="text-slate-400">
                                                                                                    Clock In: <span className="text-green-400 font-medium">
                                                                                                        {new Date(entry.clockIn).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true })}
                                                                                                    </span>
                                                                                                </span>
                                                                                                <span className="text-slate-400">
                                                                                                    Clock Out: <span className="text-red-400 font-medium">
                                                                                                        {new Date(entry.clockOut).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true })}
                                                                                                    </span>
                                                                                                </span>
                                                                                                <span className="text-white font-semibold">{entry.hoursWorked.toFixed(2)} hrs</span>
                                                                                            </div>
                                                                                            <button
                                                                                                onClick={() => {
                                                                                                    setEditingWorkEntry(entry.id);
                                                                                                    setEditingWorkTimes({ 
                                                                                                        clockIn: new Date(entry.clockIn).toISOString().slice(0, 16), 
                                                                                                        clockOut: new Date(entry.clockOut).toISOString().slice(0, 16) 
                                                                                                    });
                                                                                                }}
                                                                                                className="px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white rounded transition-colors text-sm flex items-center gap-1"
                                                                                            >
                                                                                                <Edit2 size={14} />
                                                                                                Edit
                                                                                            </button>
                                                                                        </div>
                                                                                    )}
                                                                                </div>
                                                                            ))}
                                                                        </div>
                                                                    </div>
                                                                );
                                                            })}
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            )}
                            
                            {/* Manage Employees & Tasks View */}
                            {ownerDashboardView === 'manage' && (
                                <>
                            <div className="bg-slate-800/50 backdrop-blur-xl rounded-2xl shadow-xl p-6 border border-slate-700/50 mb-8">
                                <h2 className="text-2xl font-bold text-white mb-6 flex items-center gap-2">
                                    <Plus className="text-amber-500" />
                                    Add New Employee
                                </h2>
                                <form onSubmit={handleAddEmployee} className="grid md:grid-cols-4 gap-4">
                                    <input
                                        type="text"
                                        placeholder="Full Name"
                                        value={newEmployee.name}
                                        onChange={(e) => setNewEmployee({ ...newEmployee, name: e.target.value })}
                                        className="px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50"
                                        required
                                    />
                                    <input
                                        type="text"
                                        placeholder="Username"
                                        value={newEmployee.username}
                                        onChange={(e) => setNewEmployee({ ...newEmployee, username: e.target.value })}
                                        className="px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50"
                                        required
                                    />
                                    <input
                                        type="text"
                                        placeholder="Password"
                                        value={newEmployee.password}
                                        onChange={(e) => setNewEmployee({ ...newEmployee, password: e.target.value })}
                                        className="px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50"
                                        required
                                    />
                                    <button
                                        type="submit"
                                        className="bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-400 hover:to-orange-500 text-white font-semibold py-3 rounded-lg transition-all"
                                    >
                                        Add Employee
                                    </button>
                                </form>
                            </div>

                            <div className="space-y-6">
                                {employees.map(employee => (
                                    <div key={employee.id} className="bg-slate-800/50 backdrop-blur-xl rounded-2xl shadow-xl border border-slate-700/50 overflow-hidden">
                                        <div className="bg-gradient-to-r from-slate-700/50 to-slate-800/50 p-6 border-b border-slate-700/50">
                                            <div className="flex justify-between items-start mb-4">
                                                <div className="flex-1">
                                                    <h3 className="text-2xl font-bold text-white mb-2">{employee.name}</h3>
                                                    <div className="flex flex-wrap gap-4 text-sm">
                                                        {editingEmployee === employee.id ? (
                                                            <div className="flex flex-col gap-3 w-full">
                                                                <div className="flex gap-2">
                                                                    <input
                                                                        type="text"
                                                                        defaultValue={employee.username}
                                                                        onChange={(e) => employee.tempUsername = e.target.value}
                                                                        className="px-3 py-1 bg-slate-900/50 border border-slate-600 rounded text-white text-sm"
                                                                        placeholder="Username"
                                                                    />
                                                                    <input
                                                                        type="text"
                                                                        defaultValue={employee.password}
                                                                        onChange={(e) => employee.tempPassword = e.target.value}
                                                                        className="px-3 py-1 bg-slate-900/50 border border-slate-600 rounded text-white text-sm"
                                                                        placeholder="Password"
                                                                    />
                                                                    <button
                                                                        onClick={() => handleUpdateEmployee(employee.id, {
                                                                            username: employee.tempUsername || employee.username,
                                                                            password: employee.tempPassword || employee.password,
                                                                            allowedIPs: employee.tempAllowedIPs !== undefined ? employee.tempAllowedIPs : employee.allowedIPs
                                                                        })}
                                                                        className="px-3 py-1 bg-green-600 hover:bg-green-500 text-white rounded transition-colors"
                                                                    >
                                                                        <Save size={16} />
                                                                    </button>
                                                                    <button
                                                                        onClick={() => setEditingEmployee(null)}
                                                                        className="px-3 py-1 bg-slate-600 hover:bg-slate-500 text-white rounded transition-colors"
                                                                    >
                                                                        <X size={16} />
                                                                    </button>
                                                                </div>
                                                                <div className="bg-slate-900/30 p-3 rounded-lg">
                                                                    <label className="text-slate-300 text-xs font-semibold mb-2 block">
                                                                        Allowed IP Addresses (comma-separated)
                                                                    </label>
                                                                    <input
                                                                        type="text"
                                                                        defaultValue={employee.allowedIPs?.join(', ') || ''}
                                                                        onChange={(e) => {
                                                                            const ips = e.target.value.split(',').map(ip => ip.trim()).filter(ip => ip);
                                                                            employee.tempAllowedIPs = ips;
                                                                        }}
                                                                        className="w-full px-3 py-2 bg-slate-900/50 border border-slate-600 rounded text-white text-sm"
                                                                        placeholder="e.g., 203.0.113.45, 198.51.100.123"
                                                                    />
                                                                    <p className="text-slate-500 text-xs mt-1">
                                                                        Employee can only login from these IP addresses. Leave empty to allow from anywhere.
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        ) : (
                                                            <>
                                                                <span className="text-slate-400">
                                                                    Username: <span className="text-white font-medium">{employee.username}</span>
                                                                </span>
                                                                <span className="text-slate-400">
                                                                    Password: 
                                                                    <span className="text-white font-medium ml-2">
                                                                        {showPassword[employee.id] ? employee.password : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢'}
                                                                    </span>
                                                                    <button
                                                                        onClick={() => setShowPassword({ ...showPassword, [employee.id]: !showPassword[employee.id] })}
                                                                        className="ml-2 text-blue-400 hover:text-blue-300"
                                                                    >
                                                                        {showPassword[employee.id] ? <EyeOff size={16} /> : <Eye size={16} />}
                                                                    </button>
                                                                </span>
                                                                <span className="text-slate-400 w-full">
                                                                    Allowed IPs: 
                                                                    <span className="text-white font-medium ml-2">
                                                                        {employee.allowedIPs && employee.allowedIPs.length > 0 
                                                                            ? employee.allowedIPs.join(', ') 
                                                                            : 'No restriction (can login from anywhere)'}
                                                                    </span>
                                                                </span>
                                                            </>
                                                        )}
                                                    </div>
                                                </div>
                                                <div className="flex gap-2">
                                                    {editingEmployee !== employee.id && (
                                                        <>
                                                            <button
                                                                onClick={() => setEditingEmployee(employee.id)}
                                                                className="p-2 bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 rounded-lg transition-all"
                                                                title="Edit credentials"
                                                            >
                                                                <Edit2 size={18} />
                                                            </button>
                                                            <button
                                                                onClick={() => handleDeleteEmployee(employee.id)}
                                                                className="p-2 bg-red-600/20 hover:bg-red-600/30 text-red-400 rounded-lg transition-all"
                                                                title="Delete employee"
                                                            >
                                                                <Trash2 size={18} />
                                                            </button>
                                                        </>
                                                    )}
                                                </div>
                                            </div>

                                            <div className="flex flex-wrap gap-4">
                                                <div className="flex items-center gap-2">
                                                    <div className={`w-3 h-3 rounded-full ${employee.clockedIn ? 'bg-green-500' : 'bg-red-500'}`}></div>
                                                    <span className="text-slate-300 text-sm font-medium">
                                                        {employee.clockedIn ? 'Clocked In' : 'Clocked Out'}
                                                    </span>
                                                </div>
                                                {employee.clockInTime && (
                                                    <span className="text-slate-400 text-sm">
                                                        Clock In: <span className="text-white">{formatTime(employee.clockInTime)}</span>
                                                        {' '}on{' '}
                                                        <span className="text-white">{formatDate(employee.clockInTime)}</span>
                                                    </span>
                                                )}
                                                {employee.clockOutTime && (
                                                    <span className="text-slate-400 text-sm">
                                                        Clock Out: <span className="text-white">{formatTime(employee.clockOutTime)}</span>
                                                    </span>
                                                )}
                                            </div>
                                        </div>

                                        <div className="grid md:grid-cols-2 gap-6 p-6">
                                            <div>
                                                <h4 className="text-lg font-bold text-white mb-4 flex items-center gap-2">
                                                    Daily Tasks
                                                    <span className="text-sm font-normal text-slate-400">
                                                        ({employee.dailyTasks.filter(t => t.completed).length}/{employee.dailyTasks.length})
                                                    </span>
                                                </h4>
                                                <div className="space-y-3 mb-4">
                                                    {employee.dailyTasks.map((task, index) => (
                                                        <div key={task.id} className="flex items-center gap-2 bg-slate-900/30 p-3 rounded-lg group">
                                                            <div className={`w-5 h-5 rounded border-2 flex items-center justify-center ${
                                                                task.completed ? 'bg-green-500 border-green-500' : 'border-slate-600'
                                                            }`}>
                                                                {task.completed && <span className="text-white text-xs">‚úì</span>}
                                                            </div>
                                                            
                                                            {editingTaskId === task.id ? (
                                                                <div className="flex-1 flex gap-2">
                                                                    <input
                                                                        type="text"
                                                                        value={editingTaskText}
                                                                        onChange={(e) => setEditingTaskText(e.target.value)}
                                                                        className="flex-1 px-3 py-1 bg-slate-900/50 border border-slate-600 rounded text-white text-sm"
                                                                        autoFocus
                                                                    />
                                                                    <button
                                                                        onClick={() => handleUpdateTaskText(employee.id, task.id, editingTaskText, 'dailyTasks')}
                                                                        className="px-2 py-1 bg-green-600 hover:bg-green-500 text-white rounded transition-colors"
                                                                    >
                                                                        <Save size={14} />
                                                                    </button>
                                                                    <button
                                                                        onClick={() => {
                                                                            setEditingTaskId(null);
                                                                            setEditingTaskText('');
                                                                        }}
                                                                        className="px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white rounded transition-colors"
                                                                    >
                                                                        <X size={14} />
                                                                    </button>
                                                                </div>
                                                            ) : (
                                                                <>
                                                                    <span className={`flex-1 ${task.completed ? 'text-slate-500 line-through' : 'text-slate-300'}`}>
                                                                        {task.task}
                                                                    </span>
                                                                    
                                                                    <div className="flex gap-1 opacity-0 group-hover:opacity-100 transition-all">
                                                                        <button
                                                                            onClick={() => handleMoveTask(employee.id, task.id, 'up', 'dailyTasks')}
                                                                            disabled={index === 0}
                                                                            className={`p-1 rounded transition-colors ${
                                                                                index === 0 
                                                                                    ? 'text-slate-600 cursor-not-allowed' 
                                                                                    : 'text-blue-400 hover:text-blue-300 hover:bg-blue-600/20'
                                                                            }`}
                                                                            title="Move up"
                                                                        >
                                                                            <ChevronUp size={16} />
                                                                        </button>
                                                                        <button
                                                                            onClick={() => handleMoveTask(employee.id, task.id, 'down', 'dailyTasks')}
                                                                            disabled={index === employee.dailyTasks.length - 1}
                                                                            className={`p-1 rounded transition-colors ${
                                                                                index === employee.dailyTasks.length - 1 
                                                                                    ? 'text-slate-600 cursor-not-allowed' 
                                                                                    : 'text-blue-400 hover:text-blue-300 hover:bg-blue-600/20'
                                                                            }`}
                                                                            title="Move down"
                                                                        >
                                                                            <ChevronDown size={16} />
                                                                        </button>
                                                                        <button
                                                                            onClick={() => {
                                                                                setEditingTaskId(task.id);
                                                                                setEditingTaskText(task.task);
                                                                            }}
                                                                            className="p-1 text-amber-400 hover:text-amber-300 hover:bg-amber-600/20 rounded transition-all"
                                                                            title="Edit task"
                                                                        >
                                                                            <Edit2 size={16} />
                                                                        </button>
                                                                        <button
                                                                            onClick={() => handleDeleteDailyTask(employee.id, task.id)}
                                                                            className="p-1 text-red-400 hover:text-red-300 hover:bg-red-600/20 rounded transition-all"
                                                                            title="Delete task"
                                                                        >
                                                                            <Trash2 size={16} />
                                                                        </button>
                                                                    </div>
                                                                </>
                                                            )}
                                                        </div>
                                                    ))}
                                                </div>
                                                <div className="flex gap-2">
                                                    <input
                                                        type="text"
                                                        placeholder="Add daily task..."
                                                        value={editingDailyTasks === employee.id ? newDailyTask : ''}
                                                        onChange={(e) => setNewDailyTask(e.target.value)}
                                                        onFocus={() => setEditingDailyTasks(employee.id)}
                                                        className="flex-1 px-4 py-2 bg-slate-900/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 text-sm"
                                                    />
                                                    <button
                                                        onClick={() => {
                                                            handleAddDailyTask(employee.id);
                                                            setEditingDailyTasks(null);
                                                        }}
                                                        className="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-all"
                                                    >
                                                        <Plus size={18} />
                                                    </button>
                                                </div>
                                            </div>

                                            <div>
                                                <h4 className="text-lg font-bold text-white mb-4 flex items-center gap-2">
                                                    Assigned Tasks
                                                    <span className="text-sm font-normal text-slate-400">
                                                        ({employee.assignedTasks.filter(t => t.completed).length}/{employee.assignedTasks.length})
                                                    </span>
                                                </h4>
                                                <div className="space-y-3 mb-4">
                                                    {employee.assignedTasks.map((task, index) => (
                                                        <div key={task.id} className="flex items-center gap-2 bg-slate-900/30 p-3 rounded-lg group">
                                                            <div className={`w-5 h-5 rounded border-2 flex items-center justify-center ${
                                                                task.completed ? 'bg-green-500 border-green-500' : 'border-slate-600'
                                                            }`}>
                                                                {task.completed && <span className="text-white text-xs">‚úì</span>}
                                                            </div>
                                                            
                                                            {editingTaskId === task.id ? (
                                                                <div className="flex-1 flex gap-2">
                                                                    <input
                                                                        type="text"
                                                                        value={editingTaskText}
                                                                        onChange={(e) => setEditingTaskText(e.target.value)}
                                                                        className="flex-1 px-3 py-1 bg-slate-900/50 border border-slate-600 rounded text-white text-sm"
                                                                        autoFocus
                                                                    />
                                                                    <button
                                                                        onClick={() => handleUpdateTaskText(employee.id, task.id, editingTaskText, 'assignedTasks')}
                                                                        className="px-2 py-1 bg-green-600 hover:bg-green-500 text-white rounded transition-colors"
                                                                    >
                                                                        <Save size={14} />
                                                                    </button>
                                                                    <button
                                                                        onClick={() => {
                                                                            setEditingTaskId(null);
                                                                            setEditingTaskText('');
                                                                        }}
                                                                        className="px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white rounded transition-colors"
                                                                    >
                                                                        <X size={14} />
                                                                    </button>
                                                                </div>
                                                            ) : (
                                                                <>
                                                                    <span className={`flex-1 ${task.completed ? 'text-slate-500 line-through' : 'text-slate-300'}`}>
                                                                        {task.task}
                                                                    </span>
                                                                    
                                                                    <div className="flex gap-1 opacity-0 group-hover:opacity-100 transition-all">
                                                                        <button
                                                                            onClick={() => handleMoveTask(employee.id, task.id, 'up', 'assignedTasks')}
                                                                            disabled={index === 0}
                                                                            className={`p-1 rounded transition-colors ${
                                                                                index === 0 
                                                                                    ? 'text-slate-600 cursor-not-allowed' 
                                                                                    : 'text-amber-400 hover:text-amber-300 hover:bg-amber-600/20'
                                                                            }`}
                                                                            title="Move up"
                                                                        >
                                                                            <ChevronUp size={16} />
                                                                        </button>
                                                                        <button
                                                                            onClick={() => handleMoveTask(employee.id, task.id, 'down', 'assignedTasks')}
                                                                            disabled={index === employee.assignedTasks.length - 1}
                                                                            className={`p-1 rounded transition-colors ${
                                                                                index === employee.assignedTasks.length - 1 
                                                                                    ? 'text-slate-600 cursor-not-allowed' 
                                                                                    : 'text-amber-400 hover:text-amber-300 hover:bg-amber-600/20'
                                                                            }`}
                                                                            title="Move down"
                                                                        >
                                                                            <ChevronDown size={16} />
                                                                        </button>
                                                                        <button
                                                                            onClick={() => {
                                                                                setEditingTaskId(task.id);
                                                                                setEditingTaskText(task.task);
                                                                            }}
                                                                            className="p-1 text-amber-400 hover:text-amber-300 hover:bg-amber-600/20 rounded transition-all"
                                                                            title="Edit task"
                                                                        >
                                                                            <Edit2 size={16} />
                                                                        </button>
                                                                        <button
                                                                            onClick={() => handleDeleteAssignedTask(employee.id, task.id)}
                                                                            className="p-1 text-red-400 hover:text-red-300 hover:bg-red-600/20 rounded transition-all"
                                                                            title="Delete task"
                                                                        >
                                                                            <Trash2 size={16} />
                                                                        </button>
                                                                    </div>
                                                                </>
                                                            )}
                                                        </div>
                                                    ))}
                                                </div>
                                                <div className="flex gap-2">
                                                    <input
                                                        type="text"
                                                        placeholder="Assign new task..."
                                                        value={addingTaskTo === employee.id ? newAssignedTask : ''}
                                                        onChange={(e) => setNewAssignedTask(e.target.value)}
                                                        onFocus={() => setAddingTaskTo(employee.id)}
                                                        className="flex-1 px-4 py-2 bg-slate-900/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50 text-sm"
                                                    />
                                                    <button
                                                        onClick={() => {
                                                            handleAddAssignedTask(employee.id);
                                                            setAddingTaskTo(null);
                                                        }}
                                                        className="px-4 py-2 bg-amber-600 hover:bg-amber-500 text-white rounded-lg transition-all"
                                                    >
                                                        <Plus size={18} />
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                            </>
                            )}
                        </div>
                    </div>
                );
            }

            // Employee Dashboard
            if (currentView === 'employeeDashboard') {
                const allDailyTasksCompleted = currentEmployee.dailyTasks.every(task => task.completed);
                
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900">
                        <div className="absolute inset-0 bg-[radial-gradient(circle_at_50%_120%,rgba(120,119,198,0.1),transparent)]"></div>
                        
                        <div className="relative border-b border-slate-700/50 bg-slate-800/30 backdrop-blur-xl">
                            <div className="max-w-5xl mx-auto px-6 py-4 flex justify-between items-center">
                                <div>
                                    <h1 className="text-3xl font-bold text-white" style={{ fontFamily: 'Georgia, serif' }}>WorkFlow</h1>
                                    <p className="text-slate-400 text-sm">Welcome, {currentEmployee.name}</p>
                                </div>
                                <button
                                    onClick={handleEmployeeSignOut}
                                    className="flex items-center gap-2 px-4 py-2 bg-slate-700/50 hover:bg-slate-700 text-white rounded-lg transition-all"
                                >
                                    <LogOut size={18} />
                                    Sign Out
                                </button>
                            </div>
                        </div>

                        <div className="relative max-w-5xl mx-auto px-6 py-8">
                            {error && (
                                <div className="bg-red-500/10 border border-red-500/50 text-red-400 px-4 py-3 rounded-lg mb-6 flex items-center gap-2">
                                    <AlertCircle size={18} />
                                    {error}
                                </div>
                            )}

                            <div className="bg-gradient-to-br from-blue-600 to-indigo-700 rounded-2xl shadow-2xl p-8 mb-8 text-white">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <h2 className="text-3xl font-bold mb-2" style={{ fontFamily: 'Georgia, serif' }}>
                                            {currentEmployee.clockedIn ? 'Currently Working' : 'Start Your Day'}
                                        </h2>
                                        {currentEmployee.clockedIn ? (
                                            <p className="text-blue-100">
                                                Clocked in at <span className="font-semibold">{formatTime(currentEmployee.clockInTime)}</span>
                                            </p>
                                        ) : (
                                            <p className="text-blue-100">Click the button to clock in</p>
                                        )}
                                    </div>
                                    {!currentEmployee.clockedIn ? (
                                        <button
                                            onClick={handleClockIn}
                                            className="flex items-center gap-3 bg-white text-blue-600 px-8 py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all hover:scale-105"
                                        >
                                            <Clock size={24} />
                                            Clock In
                                        </button>
                                    ) : (
                                        <button
                                            onClick={handleClockOut}
                                            className="flex items-center gap-3 bg-white text-indigo-600 px-8 py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all hover:scale-105"
                                        >
                                            <Clock size={24} />
                                            Clock Out
                                        </button>
                                    )}
                                </div>
                            </div>

                            <div className={`transition-all duration-300 ${!currentEmployee.clockedIn ? 'pointer-events-none' : ''}`}>
                                <div className={`${!currentEmployee.clockedIn ? 'blur-sm opacity-50' : ''}`}>
                                    <div className="grid md:grid-cols-2 gap-6">
                                        <div className="bg-slate-800/50 backdrop-blur-xl rounded-2xl shadow-xl p-6 border border-slate-700/50">
                                            <div className="flex items-center justify-between mb-6">
                                                <h3 className="text-2xl font-bold text-white">Daily Tasks</h3>
                                                <span className={`px-3 py-1 rounded-full text-sm font-semibold ${
                                                    allDailyTasksCompleted 
                                                        ? 'bg-green-500/20 text-green-400' 
                                                        : 'bg-amber-500/20 text-amber-400'
                                                }`}>
                                                    {currentEmployee.dailyTasks.filter(t => t.completed).length}/{currentEmployee.dailyTasks.length}
                                                </span>
                                            </div>
                                            
                                            <div className="space-y-3">
                                                {currentEmployee.dailyTasks.length === 0 ? (
                                                    <p className="text-slate-400 text-center py-8">No daily tasks assigned yet</p>
                                                ) : (
                                                    currentEmployee.dailyTasks.map(task => (
                                                        <button
                                                            key={task.id}
                                                            onClick={() => toggleDailyTask(task.id)}
                                                            className="w-full flex items-center gap-3 bg-slate-900/30 hover:bg-slate-900/50 p-4 rounded-lg transition-all group"
                                                        >
                                                            <div className={`w-6 h-6 rounded border-2 flex items-center justify-center transition-all ${
                                                                task.completed 
                                                                    ? 'bg-green-500 border-green-500' 
                                                                    : 'border-slate-600 group-hover:border-blue-500'
                                                            }`}>
                                                                {task.completed && <span className="text-white font-bold">‚úì</span>}
                                                            </div>
                                                            <span className={`flex-1 text-left transition-all ${
                                                                task.completed ? 'text-slate-500 line-through' : 'text-white'
                                                            }`}>
                                                                {task.task}
                                                            </span>
                                                        </button>
                                                    ))
                                                )}
                                            </div>
                                        </div>

                                        <div className="bg-slate-800/50 backdrop-blur-xl rounded-2xl shadow-xl p-6 border border-slate-700/50">
                                            <div className="flex items-center justify-between mb-6">
                                                <h3 className="text-2xl font-bold text-white">Assigned Tasks</h3>
                                                <span className="px-3 py-1 bg-blue-500/20 text-blue-400 rounded-full text-sm font-semibold">
                                                    {currentEmployee.assignedTasks.filter(t => t.completed).length}/{currentEmployee.assignedTasks.length}
                                                </span>
                                            </div>
                                            
                                            <div className="space-y-3">
                                                {currentEmployee.assignedTasks.length === 0 ? (
                                                    <p className="text-slate-400 text-center py-8">No assigned tasks</p>
                                                ) : (
                                                    currentEmployee.assignedTasks.map(task => (
                                                        <button
                                                            key={task.id}
                                                            onClick={() => toggleAssignedTask(task.id)}
                                                            className="w-full flex items-center gap-3 bg-slate-900/30 hover:bg-slate-900/50 p-4 rounded-lg transition-all group"
                                                        >
                                                            <div className={`w-6 h-6 rounded border-2 flex items-center justify-center transition-all ${
                                                                task.completed 
                                                                    ? 'bg-green-500 border-green-500' 
                                                                    : 'border-slate-600 group-hover:border-blue-500'
                                                            }`}>
                                                                {task.completed && <span className="text-white font-bold">‚úì</span>}
                                                            </div>
                                                            <span className={`flex-1 text-left transition-all ${
                                                                task.completed ? 'text-slate-500 line-through' : 'text-white'
                                                            }`}>
                                                                {task.task}
                                                            </span>
                                                        </button>
                                                    ))
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                {!currentEmployee.clockedIn && (
                                    <div className="absolute inset-0 flex items-center justify-center pointer-events-none">
                                        <div className="bg-slate-800/90 backdrop-blur-sm border border-slate-700 rounded-2xl px-8 py-6 text-center">
                                            <Clock size={48} className="text-blue-400 mx-auto mb-4" />
                                            <p className="text-xl font-bold text-white mb-2">Please Clock In</p>
                                            <p className="text-slate-400">Clock in to access your tasks</p>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            return null;
        };

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
